(function(){var y=navigator.userAgent;var e=(y.match(/Chrome\/([\d.]+)/)||y.match(/CriOS\/([\d.]+)/))?true:false;var A=(y.match(/(Android);?[\s\/]+([\d.]+)?/))?true:false;var n=(y.match(/(iPad).*OS\s([\d_]+)/))?true:false;var t=(!n&&y.match(/(iPhone\sOS)\s([\d_]+)/))?true:false;var f=navigator.userAgent.indexOf("MicroMessenger")>=0;var p=false;var r="plugIn_downloadAppPlugIn_loadIframe";var j=false;var c=0;var b={};var m={};var w=null;var q={};var d=window.Zepto||window.jQuery?true:false;var l=[];function x(){WeixinJSBridge.invoke("getInstallState",{packageName:"com.jingdong.app.mall",packageUrl:"openApp.jdMobile://"},function(F){var G=F.err_msg,E=0;if(G.indexOf("get_install_state:yes")>-1){p=true}})}function D(G,F,E){if(d){w("#"+G).bind(F,E)}else{w("#"+G).addEventListener(F,E,!1)}}function h(E){var F=(E||"mGen")+(++c);return F}if(f){if(window.WeixinJSBridge&&WeixinJSBridge.invoke){x()}else{document.addEventListener("WeixinJSBridgeReady",x,!1)}}if(d){w=window.$;q=window.$}else{w=function(E){if(typeof E=="object"){return E}return document.querySelector(E)};if(!window.$){window.$=q=w}else{q=window.$}}window.onblur=function(){for(var E=0;E<l.length;E++){clearTimeout(l[E])}};function z(G){var F=document.cookie.indexOf(G+"=");if(F==-1){return null}F=F+G.length+1;var E=document.cookie.indexOf(";",F);if(E==-1){E=document.cookie.length}return document.cookie.substring(F,E)}function o(G,I,E,J,H){var K=G+"="+escape(I);if(E!=""){var F=new Date();F.setTime(F.getTime()+E*24*3600*1000);K+=";expires="+F.toGMTString()}if(J!=""){K+=";path="+J}if(H!=""){K+=";domain="+H}document.cookie=K}function g(E){var G={downAppURl:"http://h5.m.jd.com/active/download/download.html?channel=jd-m",downAppIos:"http://union.m.jd.com/download/go.action?to=http%3A%2F%2Fitunes.apple.com%2Fcn%2Fapp%2Fid414245413&client=apple&unionId=12532&subunionId=m-top&key=e4dd45c0f480d8a08c4621b4fff5de74",downWeixin:"http://a.app.qq.com/o/simple.jsp?pkgname=com.jingdong.app.mall&g_f=991850",downIpad:"https://itunes.apple.com/cn/app/jing-dong-hd/id434374726?mt=8",inteneUrl:"openApp.jdMobile://360buy?type=1",inteneUrlParams:null,openAppBtnId:"",closePanelBtnId:"",closePanelId:"",closeCallblack:null,closeCallblackSource:null,cookieFlag:null,noRecord:false,openAppEventId:"MDownLoadFloat_OpenNow",closePanelEventId:"MDownLoadFloat_Close"};if(E){for(var F in E){if(F&&E[F]){G[F]=E[F]}}}return G}function s(H,E){var L=i(H);var I=null;if(f){var F=null;if(p){F=L}else{F=H.downWeixin}location.href=F;return}if(n){I=H.downIpad}else{if(t){I=H.downAppIos}else{I=H.downAppURl}}if(e){if(A){var K=L;L=v(K)}}document.querySelector("#"+r).src=L;var J=Date.now();if(E){var G=setTimeout(function(){C(J,I)},500);l.push(G)}}function C(G,F){var E=Date.now();if(G&&(E-G)<(500+200)){window.location.href=F}}function i(F){var M=[];var I=F.inteneUrlParams;var K={category:"jump",des:"productDetail",sourceType:"JSHOP_SOURCE_TYPE",sourceValue:"JSHOP_SOURCE_VALUE"};if(I){for(var L in I){if(L&&I[L]){M.push('"'+L+'":"'+I[L]+'"')}}}else{for(var L in K){if(L&&K[L]){M.push('"'+L+'":"'+K[L]+'"')}}}try{M.push('"m_param":'+MPing.EventSeries.getSeries())}catch(J){M.push('"m_param":null')}var G="{"+M.join(",")+"}";var H=F.inteneUrl.split("?");var E=null;if(H.length==2){E=H[0]+"?"+H[1]+"&params="+G}else{E=H[0]+"?params="+G}return E}function v(E){return"intent://m.jd.com/#Intent;scheme="+E+";package=com.jingdong.app.mall;end"}function B(E){if(E.openAppBtnId){b[E.openAppBtnId]=E;u(E.openAppBtnId,E.openAppEventId);D(E.openAppBtnId,"click",function(){var I=this.getAttribute("id");var F=b[I];if(!j){var G=document.createElement("iframe");G.id=r;document.body.appendChild(G);document.getElementById(r).style.display="none";document.getElementById(r).style.width="0px";document.getElementById(r).style.height="0px";j=true}var H=F.cookieFlag?"downloadAppPlugIn_downCloseDate_"+F.cookieFlag:"downloadAppPlugIn_downCloseDate";o(H,Date.now()+"_2592000000",60,"/","m.jd.com");s(F,true)})}}function a(F){if(F.closePanelBtnId&&F.closePanelId){b[F.closePanelBtnId]=F;u(F.closePanelBtnId,F.closePanelEventId);var J=F.cookieFlag?"downloadAppPlugIn_downCloseDate_"+F.cookieFlag:"downloadAppPlugIn_downCloseDate";var H=z(J);var I=null;if(H){I=H.split("_");if(I.length==2){I[0]=parseInt(I[0],10);I[1]=parseInt(I[1],10)}else{I=null}}var E=Date.now();if(!F.noRecord&&I&&I.length==2&&(E-I[0])<I[1]){document.querySelector("#"+F.closePanelId).style.display="none";if(F.closeCallblack){var G=F.closeCallblackSource?F.closeCallblackSource:null;F.closeCallblack.call(G)}return}else{document.querySelector("#"+F.closePanelId).style.display="block"}D(F.closePanelBtnId,"click",function(){var N=this.getAttribute("id");var K=b[N];var M=K.cookieFlag?"downloadAppPlugIn_downCloseDate_"+K.cookieFlag:"downloadAppPlugIn_downCloseDate";if(!K.noRecord){o(M,Date.now()+"_259200000",60,"/","m.jd.com")}document.querySelector("#"+K.closePanelId).style.display="none";if(K.closeCallblack){var L=K.closeCallblackSource?K.closeCallblackSource:null;K.closeCallblack.call(L)}})}}function u(I,F){try{var H=document.getElementById(I);var E=H.className;if(E){E=E+" J_ping"}else{E="J_ping"}H.className=E;H.setAttribute("report-eventid",F)}catch(G){}}function k(E){var F=g(E);B(F);a(F)}q.downloadAppPlugIn=k;q.downloadAppPlugInOpenApp=function(E){var F=g(E);s(F)}})();